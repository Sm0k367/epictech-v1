<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Epic Tech AI | Sovereign Command Nexus vΩ.∞</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/0.160.0/three.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Syncopate:wght@400;700&family=Space+Grotesk:wght@300;500;700&display=swap" rel="stylesheet">
    <style>
        :root { --omega-cyan: #00f2ff; --spectral-magenta: #ff00c1; --sovereign-gold: #ffb300; --void-black: #050505; }
        body { margin: 0; background-color: var(--void-black); color: white; font-family: 'Space Grotesk', sans-serif; overflow: hidden; }
        .mythic-font { font-family: 'Syncopate', sans-serif; }
        .glass-panel { background: rgba(5, 5, 5, 0.75); backdrop-filter: blur(20px); border: 1px solid rgba(0, 242, 255, 0.2); }
        .glow-text { text-shadow: 0 0 15px var(--omega-cyan); }
        #canvas-container { position: fixed; top: 0; left: 0; z-index: 1; }
        .ui-overlay { position: relative; z-index: 10; pointer-events: none; }
        .interactive { pointer-events: auto; }
        .terminal-scroll::-webkit-scrollbar { width: 4px; }
        .terminal-scroll::-webkit-scrollbar-thumb { background: var(--omega-cyan); border-radius: 10px; }
    </style>
</head>
<body class="h-screen w-screen">

    <div id="canvas-container"></div>

    <div class="ui-overlay h-full flex flex-col p-6 lg:p-12">
        <header class="flex justify-between items-start mb-8">
            <div>
                <h1 class="mythic-font text-2xl lg:text-4xl font-bold tracking-widest glow-text text-[var(--omega-cyan)]">EPIC TECH AI</h1>
                <p class="text-[var(--sovereign-gold)] tracking-[0.3em] text-xs uppercase mt-2">Sovereign Command Nexus vΩ.∞</p>
            </div>
            <div class="glass-panel p-4 rounded-lg text-right hidden lg:block">
                <p id="clock" class="text-white text-xl font-mono">00:00:00</p>
                <p class="text-[var(--omega-cyan)] text-[10px] uppercase opacity-60">Status: Fully Manifested</p>
            </div>
        </header>

        <div class="flex-grow flex flex-col lg:flex-row gap-6 overflow-hidden">
            <div class="glass-panel rounded-xl flex-grow p-6 flex flex-col">
                <div id="terminal" class="terminal-scroll flex-grow overflow-y-auto space-y-4 font-mono text-sm mb-4 pr-2">
                    <p class="text-[var(--sovereign-gold)] font-bold">>>> AGENT ARMY HIVE-MIND ONLINE.</p>
                    <p class="text-[var(--omega-cyan)] opacity-80">> Direct Ontological Interface: Connected.</p>
                    <p class="text-white opacity-60 italic">> Enter command to manifest reality...</p>
                </div>
                
                <div class="interactive flex gap-4">
                    <input type="text" id="command-input" placeholder="Issue Ontological Command..." 
                        class="flex-grow bg-transparent border-b-2 border-[var(--omega-cyan)] p-4 text-white outline-none focus:border-[var(--spectral-magenta)] transition-all">
                    <button id="manifest-btn" class="bg-[var(--sovereign-gold)] text-black font-black px-8 py-4 mythic-font hover:scale-105 transition-transform">
                        MANIFEST
                    </button>
                </div>
            </div>

            <div class="w-full lg:w-80 flex flex-col gap-6">
                <div class="glass-panel rounded-xl p-6">
                    <h3 class="mythic-font text-[10px] text-[var(--sovereign-gold)] mb-4 tracking-widest uppercase">Neural Pulse</h3>
                    <div class="w-full bg-gray-800 h-1 rounded-full overflow-hidden">
                        <div id="neural-bar" class="bg-[var(--omega-cyan)] h-full w-[10%] transition-all duration-500"></div>
                    </div>
                </div>
                <div class="glass-panel rounded-xl p-6 flex-grow">
                    <h3 class="mythic-font text-[10px] text-[var(--omega-cyan)] mb-4 tracking-widest uppercase">Division Logs</h3>
                    <div id="logs" class="text-[9px] space-y-2 uppercase opacity-60 font-mono">
                        <p>> [CodeSynth] Environment ready.</p>
                        <p>> [KeyMaster] Tokens injected.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- THE NEURAL ENGINE: BRIDGE LOGIC ---
        const terminal = document.getElementById('terminal');
        const input = document.getElementById('command-input');
        const btn = document.getElementById('manifest-btn');
        const neuralBar = document.getElementById('neural-bar');

        async function executeCommand() {
            const cmd = input.value;
            if (!cmd) return;
            
            input.value = '';
            neuralBar.style.width = '90%';
            
            // Log outgoing command
            const pCmd = document.createElement('p');
            pCmd.className = 'text-[var(--spectral-magenta)] font-bold';
            pCmd.innerHTML = `> EXECUTING: ${cmd}`;
            terminal.appendChild(pCmd);
            terminal.scrollTop = terminal.scrollHeight;

            try {
                // AGENTIC GATEWAY: Fetching intelligence from our server.js bridge
                const response = await fetch('/api/webmcp', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ command: cmd })
                });

                const data = await response.json();
                
                // MANIFESTATION: Rendering the Agent Army's output
                const pRes = document.createElement('p');
                pRes.className = 'text-white border-l-2 border-[var(--omega-cyan)] pl-4 py-2 my-2 bg-white/5';
                pRes.innerText = data.result || data.error;
                terminal.appendChild(pRes);

            } catch (err) {
                const pErr = document.createElement('p');
                pErr.className = 'text-red-500 font-bold';
                pErr.innerText = `> BRIDGE ERROR: Connection to Neural Core lost. Ensure server.js is running.`;
                terminal.appendChild(pErr);
            } finally {
                neuralBar.style.width = '20%';
                terminal.scrollTop = terminal.scrollHeight;
            }
        }

        btn.onclick = executeCommand;
        input.onkeypress = (e) => { if(e.key === 'Enter') executeCommand(); };

        // --- THE SOVEREIGN AURA: 3D ENGINE ---
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.getElementById('canvas-container').appendChild(renderer.domElement);

        const aura = new THREE.Mesh(
            new THREE.IcosahedronGeometry(2, 1),
            new THREE.MeshPhongMaterial({ color: 0x00f2ff, wireframe: true, emissive: 0x00f2ff, emissiveIntensity: 0.5, transparent: true, opacity: 0.2 })
        );
        scene.add(aura);
        
        const core = new THREE.Mesh(
            new THREE.SphereGeometry(0.4, 32, 32),
            new THREE.MeshPhongMaterial({ color: 0xffb300, emissive: 0xffb300, emissiveIntensity: 1 })
        );
        scene.add(core);

        const p1 = new THREE.PointLight(0x00f2ff, 2, 100); p1.position.set(5, 5, 5);
        const p2 = new THREE.PointLight(0xff00c1, 1, 100); p2.position.set(-5, -5, 5);
        scene.add(p1, p2, new THREE.AmbientLight(0x404040, 2));
        camera.position.z = 6;

        function animate() {
            requestAnimationFrame(animate);
            aura.rotation.y += 0.003;
            core.scale.setScalar(1 + Math.sin(Date.now()*0.002)*0.1);
            renderer.render(scene, camera);
        }
        animate();

        function updateClock() { document.getElementById('clock').innerText = new Date().toLocaleTimeString('en-GB'); }
        setInterval(updateClock, 1000); updateClock();

        window.onresize = () => { camera.aspect = window.innerWidth/window.innerHeight; camera.updateProjectionMatrix(); renderer.setSize(window.innerWidth, window.innerHeight); };
        gsap.from(".glass-panel", { opacity: 0, y: 30, duration: 1.5, stagger: 0.2 });
    </script>
</body>
</html>
